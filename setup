#Clear Directory, remove once debug is done.
sudo rm -rf ~/clang+llvm

echo "Install Deps"
sudo apt-get update
sudo apt-get install -y software-properties-common
sudo add-apt-repository -y ppa:george-edison55/cmake-3.x
sudo apt-get update
sudo apt-get upgrade -y
sudo apt-get install -y \
	cmake \
	zlib1g-dev

echo "Install Rust"
curl --proto '=https' --tlsv1.2 -sSf https://sh.rustup.rs | sh

#echo 'export PATH=/usr/local/bin:$PATH' >> ~/.bashrc
#echo 'export LD_LIBRARY_PATH=/lib:$LD_LIBRARY_PATH'  >> ~/.bashrc
echo 'export PATH=/home/multipass/clang+llvm/bin:\$PATH' >> ~/.bashrc 
echo 'export LD_LIBRARY_PATH=/home/multipass/clang+llvm/lib:\$LD_LIBRARY_PATH' >> ~/.bashrc
echo 'sudo sysctl kernel.core_pattern=core' >> ~/.bashrc
echo -e "export PATH=$HOME/.cargo/bin:$PATH" >> ~/.bashrc 
source ~/.bashrc


echo "Build Angora + LLVM"
./build/build.sh

echo "Test Angora"
cd ./tests
./test.sh infer_type
