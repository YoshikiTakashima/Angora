#Clear Directory, remove once debug is done.
sudo rm -rf ~/clang+llvm

echo "Install Deps"
sudo apt-get update
sudo add-apt-repository -y ppa:george-edison55/cmake-3.x
sudo apt-get update
sudo apt-get upgrade -y
sudo apt-get install -y \
	cmake \
	zlib1g-dev

echo "Install Rust"
curl --proto '=https' --tlsv1.2 -sSf https://sh.rustup.rs | sh

echo 'sudo sysctl kernel.core_pattern=core' >> ~/.bashrc
echo -e "if ! [ -x \"$(command -v llvm-config)\"  ]; then\n
    export PATH=${HOME}/clang+llvm/bin:$PATH \n
    export LD_LIBRARY_PATH=${HOME}/clang+llvm/lib${LD_LIBRARY_PATH:+:$LD_LIBRARY_PATH} \n
    export CC=clang\n
    export CXX=clang++\n
fi" >> ~/.bashrc 
source ~/.bashrc


echo "Build Angora + LLVM"
./build/build.sh

echo "Test Angora"
cd ./tests
./test.sh infer_type
